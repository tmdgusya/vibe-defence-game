# ISSUE: No UI Button to Start Wave - Only Keyboard Works

## Metadata

- **Reporter**: Senior Developer (Claude)
- **Date Reported**: 2026-01-13
- **Last Updated**: 2026-01-13
- **Status**: Open
- **Priority**: High
- **Type**: Bug / UX
- **Assignee**: [Junior Developer]
- **Labels**: ux, ui, accessibility, high-priority
- **Related Issue ID**: N/A

## 1. Issue Summary

### One-Sentence Summary

Players can only start waves by pressing the SPACE key; there is no visible UI button, causing confusion and accessibility issues.

### Impact Assessment

- **Users Affected**: 100% of new players
- **Severity**: Major - Users cannot discover how to play
- **Business Impact**: Poor user experience; players may abandon game

## 2. Issue Classification

### Type Details

**Bug/UX**: The existing "▶" button in the UI toggles the Tower Panel visibility, NOT wave start. Users expect this button to start the wave.

### Reproducibility

- **Can Reproduce**: Always
- **First Seen**: Current version (v0.1.0)
- **Frequency**: Every game session

## 3. Environment & Context

### Affected Components

- [x] **UI Framework**: React
- [x] **System**: Wave management, user controls
- [ ] **Game Engine**: Phaser (works correctly with SPACE key)

### Reproduction Steps

1. Start the game at `http://localhost:3000`
2. Look for a "Start Wave" button - none visible
3. Click the "▶" button on the right side of game area
4. Observe that it only shows/hides the Tower Panel
5. Without knowing to press SPACE, user is stuck

### Expected Behavior

- A clear "Start Wave" or "▶ Wave 1" button should be visible
- Button should be in Wave Progress panel or near game area
- Clicking button should call `enemySystem.startWave()`

### Actual Behavior

- "▶" button exists but controls Tower Panel visibility (`showTowerPanel` state)
- No wave start button exists
- Only SPACE key starts waves (undiscoverable)

## 4. Technical Details

### Code Context

```typescript
// src/components/GameUI.tsx:98-106 - The misleading button
<button
  onClick={() => setShowTowerPanel(!showTowerPanel)}  // NOT wave start!
  className="bg-gray-700 hover:bg-gray-600..."
  title={showTowerPanel ? 'Hide Tower Panel' : 'Show Tower Panel'}
>
  {showTowerPanel ? '◀' : '▶'}
</button>
```

```typescript
// src/scenes/GameScene.ts:249-252 - The only way to start wave
this.input.keyboard?.on('keydown-SPACE', () => {
  if (!this.enemySystem.isWaveInProgress()) {
    this.enemySystem.startWave(this.currentWave);
  }
});
```

### Files to Modify

1. `src/components/WaveProgress.tsx` - Add Start Wave button
2. `src/components/GameUI.tsx` - Consider removing/relocating panel toggle button
3. `src/utils/EventBus.ts` - May need new event type

## 5. Root Cause Analysis

### Hypothesis

Wave start functionality was implemented only via keyboard shortcut during development, and the UI button was never added before reaching playable state.

### Investigation Notes

- **Test 1**: Searched for "startWave" in React components - Not found
- **Test 2**: Verified SPACE key works in GameScene - Yes
- **Test 3**: Found "▶" button is for panel toggle, not wave start

## 6. Solution Strategy

### Recommended Solution

Add "Start Wave" button to `WaveProgress.tsx` component.

### Implementation Approach

```typescript
// In WaveProgress.tsx, add:
import { emitEvent } from '../utils/EventBus';

const WaveProgress: React.FC<WaveProgressProps> = ({ totalWaves = 10 }) => {
  const [isWaveActive, setIsWaveActive] = useState(false);

  const handleStartWave = () => {
    if (!isWaveActive) {
      emitEvent('startWave', { wave }); // Need to add this event type
      setIsWaveActive(true);
    }
  };

  // Subscribe to waveCompleted to reset button
  useEffect(() => {
    const handleWaveCompleted = () => setIsWaveActive(false);
    subscribeToEvent('waveCompleted', handleWaveCompleted);
    return () => unsubscribeFromEvent('waveCompleted', handleWaveCompleted);
  }, []);

  return (
    <div className="...">
      {/* ... existing content ... */}

      <button
        onClick={handleStartWave}
        disabled={isWaveActive || isPaused}
        className={`
          w-full py-3 rounded-lg font-bold text-lg
          ${isWaveActive
            ? 'bg-gray-600 cursor-not-allowed'
            : 'bg-green-600 hover:bg-green-500 cursor-pointer'}
        `}
      >
        {isWaveActive ? `Wave ${wave} in Progress...` : `Start Wave ${wave}`}
      </button>
    </div>
  );
};
```

**Alternative**: Handle in GameScene by subscribing to a new `startWaveRequested` event.

## 7. Implementation Plan

### Development Tasks

- [ ] **Task 1**: Add `startWave` or `startWaveRequested` event type to EventBus
- [ ] **Task 2**: Add "Start Wave" button to `WaveProgress.tsx`
- [ ] **Task 3**: Subscribe to event in `GameScene.ts` to call `enemySystem.startWave()`
- [ ] **Task 4**: Add button state management (disabled during active wave)
- [ ] **Task 5**: Style button appropriately (prominent, clear action)
- [ ] **Task 6**: Add keyboard hint text "(or press SPACE)"

### Testing Requirements

- [ ] **Manual Testing**:
  - Click Start Wave button → Wave starts
  - Button disabled during wave → Cannot click again
  - Wave completes → Button re-enabled for next wave
  - SPACE key still works alongside button
- [ ] **Accessibility Testing**: Button is keyboard focusable, has ARIA labels

### Dependencies

- Should be done after ISSUE-BUG-001 (lives) and ISSUE-BUG-002 (gold) so testing is meaningful

## 8. Verification & Acceptance

### Definition of Done

- [ ] "Start Wave" button visible in Wave Progress panel
- [ ] Clicking button starts the wave
- [ ] Button disabled during active wave
- [ ] Button shows wave number ("Start Wave 1", "Start Wave 2", etc.)
- [ ] SPACE key still works as alternative
- [ ] Keyboard hint displayed ("Press SPACE or click to start")

### Test Scenarios

1. New game → "Start Wave 1" button visible and enabled
2. Click button → Wave 1 starts, button shows "Wave 1 in Progress..."
3. Wave completes → Button changes to "Start Wave 2"
4. During wave, press button → Nothing happens (disabled)

## 9. Related Documents

- [WaveProgress.tsx](../../src/components/WaveProgress.tsx)
- [GameScene.ts](../../src/scenes/GameScene.ts)
- [GameUI.tsx](../../src/components/GameUI.tsx)

## 10. Revision History

| Version | Date       | Author     | Changes        |
| ------- | ---------- | ---------- | -------------- |
| v1.0    | 2026-01-13 | Senior Dev | Issue reported |
